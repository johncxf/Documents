## 安装配置

本文档记录平时开发配置环境时经常使用的，已经踩过的坑

#### MySQL

##### 安装

很多安装方式，这里不在讲解

##### 启动

**源码安装**

```
//关闭MySQL
$mysql_dir/bin/mysqladmin -uroot -p shutdown
//启动MySQL的命令
$mysql_dir/bin/mysqld_safe &
```

**jumbo**安装

```
sh ${JUMBO_ROOT}/share/mysql/mysql.server start/stop
```

##### 密码重置

在配置文件中 [mysqld] 下添加 `skip-grant-tables`，保存退出（忘记密码情况）
重启 mysql服务
进入mysql `mysql -uroot -p`

执行改密码

```
mysql > use mysql;
mysql >  update user set password=password('root') where user='root';   
mysql > flush privileges;
mysql > exit;
```

在配置文件中 [mysqld] 下删除 `skip-grant-tables`，保存退出

重启 mysql 服务

**注意：**以上只是一种修改mysql密码的方法，而且不适用与高版本mysql

##### 开启远程访问

```
进入 mysql 命令行模式
mysql > use mysql;
mysql > update user set host='%' where host='localhost' and user='root';
mysql > grant all privileges on *.* to 'root'@'localhost' identified by 'root';
mysql > flush privileges;
mysql > exit
```

查看状态

```
ss -tlnp
显示*:3306则可以
```

#### samba

##### 安装

```
yum install -y samba samba-client
```

##### 配置

`以下/etc/samba/smb.conf`文件主要配置的讲解

```
# 全局配置
global]
				# 定义工作组
        workgroup = MYGROUP
        # 
        server string = Samba Server Version %v
        # samba的安全等级，有以下四种
        # 1.share：用户不需要账户及密码即可登录samba服务器
				# 2.user：由提供服务的samba服务器负责检查账户及密码（默认）
				# 3.server：检查账户及密码的工作由另一台windows或samba服务器负责
				#	4.domain：指定windows域控制服务器来验证用户的账户及密码。
        security = user
        # 用户后台，有以下三种
        # 1.smbpasswd：该方式是使用smb工具smbpasswd给系统用户（真实用户或者虚拟用户）设置一个Samba 密码，客户端就用此密码访问Samba资源。smbpasswd在/etc/samba中，有时需要手工创建该文件。
        # 2.tdbsam：使用数据库文件创建用户数据库。数据库文件叫passdb.tdb，在/etc/samba中。passdb.tdb用户数据库可使用smbpasswd -a work创建Samba用户，要创建的Samba用户必须先是系统用户。也可使用pdbedit创建Samba账户。pdbedit参数很多，列出几个主要的：
            # pdbedit –a username：新建Samba账户。
            # pdbedit –x username：删除Samba账户。
            # pdbedit –L：列出Samba用户列表，读取passdb.tdb数据库文件。
            # pdbedit –Lv：列出Samba用户列表详细信息。
            # pdbedit –c “[D]” –u username：暂停该Samba用户账号。
            # pdbedit –c “[]” –u username：恢复该Samba用户账号。
				#3.ldapsam：基于LDAP账户管理方式验证用户。首先要建立LDAP服务，设置“passdb backend = ldapsam:ldap://LDAP Server”
        passdb backend = tdbsam
        # load printers 和 cups options 两个参数用来设置打印机相关
        load printers = yes
        cups options = raw
        # 以下配置可以了解
        netbios name = MYSERVER  # 设置出现在“网上邻居”中的主机名
				hosts allow = 127.192.168.12.  192.168.13. # 用来设置允许的主机，如果在前面加”;”则表示允许所有主机
				log file = /var/log/samba/%m.log #定义samba的日志，这里的%m是上面的netbios name
				max log size = 50 # 指定日志的最大容量，单位是K
# 该部分内容共享用户自己的家目录，也就是说，当用户登录到samba服务器上时实际上是进入到了该用户的家目录，用户登陆后，共享名不是homes而是用户自己的标识符，对于单纯的文件共享的环境来说，这部分可以注视掉。
[homes]
        comment = Home Directories
        browseable = no
        writable = yes
# 该部分内容设置打印机共享
[printers]
        comment = All Printers
        path = /var/spool/samba
        browseable = no
        guest ok = no
        writable = no
        printable = yes
```

在配置文件中加入

```
# 这下是配置work
[work]
   comment = home work
   path = /home/work
   public = no
   browseable = yes
   writable = yes
   valid users = work
```

再执行`smbpasswd -a work`添加帐户到`samba`

##### 本地连接

**mac**

打开`Finder`，按`command+k`（或者点菜单中的 前往->服务器），输入地址（ip/work/）或者`ip`，使用`work`帐户登录，链接之后在命令行里的路径是：`/home/work/`

**win**

使用运行命令(`win+R`)，输入`//IP`可打开，也可以打开`我的电脑`右击选择`添加一个网络位置`，输入`//IP/work`可映射到本地为一个盘符

